# 📅 2026-01-14 (수) 데일리 회고록
**🏷️ Tags:** #AWS #S3 #CloudFront #VPC #Route53 #Network #01월

---

## 📚 학습 내용
> 오늘 공부하면서 새롭게 배운 내용이나 정리한 개념

- **S3 (Simple Storage Service)**
    - **객체 스토리지**: 파일(객체) 단위로 데이터를 저장하며 무제한 용량과 99.999999999%(119s)의 높은 내구성을 제공한다.
    - **스토리지 비교**:
        - **S3**: 객체 스토리지, 인터넷 접근 가능, 정적 파일 저장소.
        - **EBS**: 블록 스토리지, EC2에 장착하는 하드디스크(단일 연결).
        - **EFS**: 파일 스토리지, 여러 EC2에서 공유 가능한 네트워크 드라이브(NAS).

- **CloudFront (CDN)**
    - 전 세계에 분산된 **엣지 로케이션(Edge Location)**에 콘텐츠를 캐싱하여 사용자에게 빠르게 제공하는 CDN 서비스.
    - **OAC (Origin Access Control)**: S3 버킷을 퍼블릭으로 열지 않고도, CloudFront를 통해서만 안전하게 접근하도록 하는 보안 구성 방식.

- **VPC & Subnet (네트워크)**
    - **VPC**: 클라우드 내의 격리된 가상 네트워크 공간.
    - **서브넷(Subnet)**: VPC를 잘게 쪼갠 단위.
        - **Public Subnet**: IGW(인터넷 게이트웨이)와 연결되어 외부 통신 가능.
        - **Private Subnet**: 외부 접근 불가. 외부로 나갈 때는 **NAT Gateway**를 통해야 함.
    - **CIDR**: IP 주소 범위를 지정하는 방식 (예: 10.0.0.0/16).

- **Route 53 (DNS)**
    - AWS의 DNS 서비스 (포트 53번에서 유래). 도메인 이름을 IP 주소로 변환해준다.
    - **Health Check & Failover**: 서버 상태를 주기적으로 체크하여, 장애 발생 시 자동으로 백업 서버로 트래픽을 돌리는 고가용성 기능을 제공한다.

---

## 🧑🏻‍💻 코드 예제
> 수업 시간에 작성한 핵심 코드나 직접 변형한 코드

```json
// 1. S3 버킷 정책 (CloudFront OAC만 접근 허용)
{
    "Version": "2012-10-17",
    "Statement": {
        "Sid": "AllowCloudFrontServicePrincipalReadOnly",
        "Effect": "Allow",
        "Principal": {
            "Service": "cloudfront.amazonaws.com"
        },
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::my-bucket-name/*",
        "Condition": {
            "StringEquals": {
                "AWS:SourceArn": "arn:aws:cloudfront::123456789012:distribution/EDFDVBD632BHDS5"
            }
        }
    }
}
```

```javascript
// 2. React에서 S3 Presigned URL 등을 이용한 다운로드 로직 (개념적용)
const downloadFile = async () => {
  try {
    const response = await axios.get("API_GATEWAY_URL", { 
        params: { filename: "image.png" } 
    });
    // 받아온 URL로 새 창을 띄워 다운로드
    window.open(response.data.url, "_blank");
  } catch (err) {
    console.error("다운로드 실패:", err);
  }
};
```

---

## 💣 Trouble Shooting
> 발생한 문제와 해결책

- **문제**: CloudFront를 생성하고 S3와 연결했는데 `Access Denied` 에러가 발생함.
- **해결**: 과거에는 OAI(Origin Access Identity)를 썼지만, 최신 권장 방식인 **OAC(Origin Access Control)**를 사용해야 함. S3 버킷의 '퍼블릭 액세스 차단'은 켜두고(Block All), 버킷 정책(Bucket Policy)에 CloudFront의 접근을 허용하는 JSON 정책을 추가하여 해결함.

- **문제**: 프라이빗 서브넷에 있는 EC2에서 `yum update`를 실행했는데 인터넷 연결이 안 되어 타임아웃 발생.
- **해결**: 프라이빗 서브넷은 외부 인터넷과 직접 통신할 수 없음. 퍼블릭 서브넷에 **NAT Gateway**를 생성하고, 프라이빗 서브넷의 라우트 테이블이 NAT Gateway를 바라보도록 설정하여 해결함.

---
## 🌟 잘한 점
> 오늘 하루 스스로 칭찬할 만한 점

- S3를 단순 저장소로 쓰는 것을 넘어, CloudFront와 연동하여 전송 속도를 높이고 보안(OAC)까지 챙기는 구성을 직접 실습해본 점.
- 헷갈리기 쉬운 VPC의 Public/Private 서브넷 개념과 NAT Gateway의 역할을 명확히 정리한 점.

---

## ⚠️ 아쉬운 점
> 부족했던 점

- CIDR 계산(서브넷 마스킹)이 아직 익숙하지 않아서, IP 대역을 쪼갤 때 호스트 개수가 몇 개 나오는지 바로 계산이 안 된다. 이 부분은 별도로 연습이 필요하다.

---

## 🤔 내일 시도할 점
> 내일 시도하고 싶은 부분

- Route 53의 Failover 라우팅 정책을 사용하여, 메인 서버가 죽었을 때 S3 정적 웹 호스팅 페이지(공사중 페이지)로 자동 전환되는 구성을 만들어보고 싶다.

---

## 💬 한줄평
> 오늘 하루를 한 문장으로 정리

> "사용자는 Route53으로 길을 찾고, CloudFront라는 고속도로를 타고, S3라는 창고에 도착한다."